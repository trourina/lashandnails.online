# Internationalization (i18n) Guide

This document explains how internationalization works in the Lash & Nails website.

## Overview

The website uses `@nuxtjs/i18n` module with three languages:
- **English (en)** - Default and fallback language
- **Spanish (es)** - Primary local language
- **Russian (ru)** - For Russian-speaking visitors

## Configuration

### Nuxt Config (`nuxt.config.ts`)

```ts
i18n: {
  baseUrl: BUSINESS.url,
  locales: [
    { code: "en", language: "en", name: "English" },
    { code: "es", language: "es", name: "Español" },
    { code: "ru", language: "ru", name: "Русский" },
  ],
  defaultLocale: "en",
  strategy: "prefix",
  detectBrowserLanguage: {
    useCookie: true,
    cookieKey: "i18n_redirected",
    redirectOn: "root",
  },
  vueI18n: "./i18n.config.ts",
}
```

### Vue I18n Config (`i18n.config.ts`)

```ts
export default defineI18nConfig(() => ({
  legacy: false,      // Use Composition API mode
  locale: 'en',       // Default locale
  fallbackLocale: 'en', // Fallback when translation missing
}))
```

## URL Strategy

The website uses the **prefix** strategy, meaning all routes have a language prefix:

| Route | Language |
|-------|----------|
| `/en/` | English |
| `/es/` | Spanish |
| `/ru/` | Russian |
| `/en/services/lash-extensions` | English |
| `/es/services/lash-extensions` | Spanish |
| `/ru/services/lash-extensions` | Russian |

## Translation Approaches

### 1. Local Component Translations (Recommended)

Use `<i18n>` blocks within Vue components for page-specific content. This approach:
- Enables better tree-shaking (unused translations are removed)
- Keeps translations close to where they're used
- Improves code splitting

**Example: Page with local translations**

```vue
<template>
  <h1>{{ t('title') }}</h1>
  <p>{{ t('description') }}</p>
</template>

<script setup lang="ts">
// IMPORTANT: Use useScope: 'local' for component-specific translations
const { t } = useI18n({ useScope: 'local' })
</script>

<i18n lang="json">
{
  "es": {
    "title": "Mi Título",
    "description": "Mi descripción"
  },
  "en": {
    "title": "My Title",
    "description": "My description"
  },
  "ru": {
    "title": "Мой заголовок",
    "description": "Моё описание"
  }
}
</i18n>
```

**Critical Rule**: Always use `t()` from `useI18n()`, NOT `$t()` when using local `<i18n>` blocks.

### 2. Global Translations

Store shared translations in `i18n/locales/`:
- `i18n/locales/en.json`
- `i18n/locales/es.json`
- `i18n/locales/ru.json`

**Use global translations for:**
- Navigation menus
- Common UI elements (buttons, labels)
- Shared error messages
- Footer content

**Example: Global translation file (`i18n/locales/en.json`)**

```json
{
  "nav": {
    "home": "Home",
    "services": "Services",
    "gallery": "Gallery",
    "contact": "Contact"
  },
  "common": {
    "loading": "Loading...",
    "error": "Error",
    "close": "Close"
  }
}
```

## Composables

### `useI18n()`

The primary composable for translations.

```ts
const { t, locale, locales } = useI18n({ useScope: 'local' })

// t() - Translation function
t('key')                    // Simple key
t('nested.key')             // Nested key
t('greeting', { name: 'John' }) // With interpolation

// locale - Current locale (reactive ref)
console.log(locale.value)   // 'en', 'es', or 'ru'

// locales - All available locales
console.log(locales.value)  // Array of locale objects
```

### `useLocalePath()`

Generate locale-aware paths for navigation.

```ts
const localePath = useLocalePath()

// In template
<NuxtLink :to="localePath('/')">Home</NuxtLink>
<NuxtLink :to="localePath('/services')">Services</NuxtLink>
<NuxtLink :to="localePath('/services/lash-extensions')">Lash Extensions</NuxtLink>
```

### `useSwitchLocalePath()`

Generate paths to switch between languages.

```ts
const switchLocalePath = useSwitchLocalePath()

// In template - links to current page in different language
<NuxtLink :to="switchLocalePath('es')">Español</NuxtLink>
<NuxtLink :to="switchLocalePath('en')">English</NuxtLink>
<NuxtLink :to="switchLocalePath('ru')">Русский</NuxtLink>
```

## SEO with i18n

### Per-Page SEO Meta

Use reactive functions to ensure translations update with locale changes:

```vue
<script setup lang="ts">
const { t, locale } = useI18n({ useScope: 'local' })

useSeoMeta({
  title: () => t('seoTitle'),           // Reactive!
  description: () => t('seoDescription'),
  ogTitle: () => t('seoTitle'),
  ogDescription: () => t('seoDescription'),
  ogType: 'website',
  ogLocale: () => locale.value === 'es' ? 'es_ES'
               : locale.value === 'ru' ? 'ru_RU'
               : 'en_US',
})
</script>

<i18n lang="json">
{
  "es": {
    "seoTitle": "Mi Página | Lash & Nails Santa Pola",
    "seoDescription": "Descripción SEO en español"
  },
  "en": {
    "seoTitle": "My Page | Lash & Nails Santa Pola",
    "seoDescription": "SEO description in English"
  },
  "ru": {
    "seoTitle": "Моя страница | Lash & Nails Santa Pola",
    "seoDescription": "SEO описание на русском"
  }
}
</i18n>
```

### Automatic SEO Features

The `@nuxtjs/i18n` module automatically generates:
- **Canonical URLs** - Do NOT add manual canonical links
- **hreflang tags** - For language alternatives
- **Sitemap** - With all language variants

## Language Switcher Implementation

The Header component (`app/components/Header.vue`) includes a language switcher:

```vue
<script setup lang="ts">
const { locale, locales } = useI18n({ useScope: 'local' })
const switchLocalePath = useSwitchLocalePath()

const localeNames: Record<string, string> = {
  en: 'EN',
  es: 'ES',
  ru: 'RU',
}

const availableLocales = computed(() => {
  return locales.value.filter((i) => i.code !== locale.value)
})
</script>

<template>
  <NuxtLink
    v-for="loc in availableLocales"
    :key="loc.code"
    :to="switchLocalePath(loc.code)"
  >
    {{ localeNames[loc.code] }}
  </NuxtLink>
</template>
```

## Browser Language Detection

The website automatically detects browser language:

```ts
detectBrowserLanguage: {
  useCookie: true,           // Remember user's choice
  cookieKey: 'i18n_redirected', // Cookie name
  redirectOn: 'root',        // Only redirect on root path
}
```

- First visit: Redirects to browser language if supported
- Subsequent visits: Uses saved cookie preference
- Users can always switch manually

## Working with Arrays and Objects

For lists and complex data structures in translations:

```vue
<script setup lang="ts">
const { t } = useI18n({ useScope: 'local' })

// Access array items
const benefits = computed(() => [
  t('benefits.items.0'),
  t('benefits.items.1'),
  t('benefits.items.2'),
])

// Access object properties
const techniques = computed(() => [
  {
    name: t('techniques.classic.name'),
    description: t('techniques.classic.description'),
  },
  {
    name: t('techniques.volume.name'),
    description: t('techniques.volume.description'),
  },
])
</script>

<i18n lang="json">
{
  "en": {
    "benefits": {
      "items": [
        "First benefit",
        "Second benefit",
        "Third benefit"
      ]
    },
    "techniques": {
      "classic": {
        "name": "Classic",
        "description": "One extension per lash"
      },
      "volume": {
        "name": "Volume",
        "description": "Multiple extensions per lash"
      }
    }
  }
}
</i18n>
```

## Special Characters

When using special characters like `@` in translations, escape them:

```json
{
  "email": "info{'@'}lashandnails.es"
}
```

## File Structure

```
├── i18n/
│   └── locales/
│       ├── en.json    # Global English translations
│       ├── es.json    # Global Spanish translations
│       └── ru.json    # Global Russian translations
├── i18n.config.ts     # Vue I18n configuration
├── nuxt.config.ts     # Nuxt i18n module config
└── app/
    ├── components/
    │   └── Header.vue # Component with <i18n> block
    └── pages/
        ├── index.vue  # Page with <i18n> block
        └── services/
            └── lash-extensions.vue # Service page with translations
```

## Best Practices Summary

1. **Use local `<i18n>` blocks** for page/component-specific content
2. **Use global translations** only for shared content (nav, footer, common UI)
3. **Always use `t()` not `$t()`** with local translations
4. **Include `useScope: 'local'`** when using `useI18n()` with local translations
5. **Use reactive functions `() => t('key')`** in `useSeoMeta()`
6. **Use `localePath()`** for all internal navigation links
7. **Don't add manual canonical links** - they're auto-generated
8. **Keep translations complete** - all three languages for every key
